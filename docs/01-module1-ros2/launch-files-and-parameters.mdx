---
id: launch-files-and-parameters
title: Launch Files and Parameters
sidebar_position: 3
slug: /01-module1-ros2/launch-files-and-parameters
---

import Admonition from '@theme/Admonition';
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

## Managing Complex Systems with Launch Files and Parameters

As your robotics applications grow, manually running each node in a separate terminal becomes tedious and error-prone. ROS 2 provides a powerful tool to manage this complexity: **Launch files**. Additionally, to make your nodes more flexible, ROS 2 has a **Parameter** system for configuring nodes without changing their code.

### What is a Launch File?

A ROS 2 launch file is a script (usually written in Python) that can:
-   Start multiple nodes at once.
-   Automatically restart nodes if they crash.
-   Pass configuration parameters to nodes.
-   Remap topic names, and much more.

It allows you to describe the entire structure of your application and launch it with a single command.

### Step 1: Create a `launch` Directory

By convention, launch files are placed in a `launch` directory inside your package.

```bash
cd ~/ros2_ws/src/my_first_package
mkdir launch
```

### Step 2: Create a Python Launch File

Let's create a launch file to start both our publisher and subscriber nodes from the previous chapter.

**File: `launch/my_first_launch.py`**
```python
from launch import LaunchDescription
from launch_ros.actions import Node

def generate_launch_description():
    return LaunchDescription([
        Node(
            package='my_first_package',
            executable='my_publisher',
            name='custom_publisher_node'
        ),
        Node(
            package='my_first_package',
            executable='my_subscriber',
            name='custom_subscriber_node'
        ),
    ])
```

-   `generate_launch_description()`: This is the main function that the `ros2 launch` command looks for.
-   `LaunchDescription`: This object holds the list of all actions to be performed, in our case, starting nodes.
-   `Node`: This action describes a node to be launched, specifying its package, executable name, and an optional custom name.

### Step 3: Update `setup.py` to Install the Launch File

You need to tell the build system to find and install your launch files.

Open `setup.py` and add the `install_launch` function to install files from the `launch` directory.

```python
# setup.py
import os
from glob import glob
from setuptools import setup

package_name = 'my_first_package'

def install_launch():
    return [
        ('share/ament_index/resource_index/packages', ['resource/' + package_name]),
        ('share/' + package_name, ['package.xml']),
        # Install launch files
        (os.path.join('share', package_name, 'launch'), glob('launch/*.py')),
    ]

setup(
    name=package_name,
    version='0.0.0',
    packages=[package_name],
    data_files=install_launch(), # Use the new function here
    install_requires=['setuptools'],
    zip_safe=True,
    maintainer='user',
    maintainer_email='user@example.com',
    description='My first ROS 2 package',
    license='Apache 2.0',
    tests_require=['pytest'],
    entry_points={
        'console_scripts': [
            'my_publisher = my_first_package.my_publisher:main',
            'my_subscriber = my_first_package.my_subscriber:main',
        ],
    },
)
```

### Step 4: Build and Run the Launch File

1.  Re-build your workspace to install the launch file:
    ```bash
    cd ~/ros2_ws
    colcon build
    ```
2.  Source the workspace:
    ```bash
    source install/setup.bash
    ```
3.  Execute the launch file:
    ```bash
    ros2 launch my_first_package my_first_launch.py
    ```
You should see both the publisher and subscriber nodes start up in the same terminal.

---

### Making Nodes Configurable with Parameters

Hardcoding values inside your code is inflexible. ROS 2 **Parameters** allow you to change a node's behavior from the outside.

#### Step 1: Declare and Use a Parameter in Your Node

Let's modify our publisher to have a configurable publishing frequency.

**File: `my_first_package/my_publisher.py`**
```python
import rclpy
from rclpy.node import Node
from rcl_interfaces.msg import ParameterDescriptor
from std_msgs.msg import String

class MyPublisherNode(Node):
    def __init__(self):
        super().__init__('my_publisher_node')
        
        # Declare a parameter with a default value
        param_descriptor = ParameterDescriptor(description='The publishing frequency in Hz.')
        self.declare_parameter('publish_frequency', 2.0, param_descriptor)
        
        # Get the parameter value
        frequency = self.get_parameter('publish_frequency').get_parameter_value().double_value
        
        self.publisher_ = self.create_publisher(String, 'chatter', 10)
        self.timer = self.create_timer(1.0 / frequency, self.timer_callback)
        self.counter = 0
        self.get_logger().info(f'Publisher started with frequency: {frequency} Hz')

    def timer_callback(self):
        msg = String()
        msg.data = f'Hello from my_first_package! Message #{self.counter}'
        self.publisher_.publish(msg)
        self.get_logger().info(f'Publishing: "{msg.data}"')
        self.counter += 1

# ... (main function remains the same)
```

-   `self.declare_parameter('param_name', default_value, descriptor)`: This makes the node aware of a parameter.
-   `self.get_parameter('param_name').get_parameter_value()`: This retrieves the current value of the parameter.

#### Step 2: Pass Parameters from a Launch File

Now, let's update our launch file to set this parameter.

**File: `launch/my_first_launch.py`**
```python
from launch import LaunchDescription
from launch_ros.actions import Node

def generate_launch_description():
    return LaunchDescription([
        Node(
            package='my_first_package',
            executable='my_publisher',
            name='custom_publisher_node',
            parameters=[
                {'publish_frequency': 5.0} # Set the parameter here
            ]
        ),
        Node(
            package='my_first_package',
            executable='my_subscriber',
            name='custom_subscriber_node'
        ),
    ])
```

#### Step 3: Build and Verify

1.  Re-build the workspace:
    ```bash
    cd ~/ros2_ws
    colcon build
    ```
2.  Run the launch file:
    ```bash
    ros2 launch my_first_package my_first_launch.py
    ```

Now, you will see the publisher's log message indicating it started with a frequency of `5.0 Hz`, and the messages will be published much faster. You have successfully made your node configurable without touching its source code! This is a fundamental technique for creating reusable and flexible robotics software.
