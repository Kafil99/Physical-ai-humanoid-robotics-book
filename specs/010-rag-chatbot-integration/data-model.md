# Data Models: RAG Chatbot Integration

**Purpose**: This document defines the key data structures used in the RAG Chatbot feature, primarily for the communication between the frontend and the backend.

---

## 1. Chat Payload

-   **Description**: The JSON object sent from the frontend to the backend (`POST /chat`) when a user submits a query.
-   **Source**: [Feature Spec: Key Entities](spec.md#key-entities)

### Attributes

| Name            | Type   | Required | Description                                                  |
| --------------- | ------ | -------- | ------------------------------------------------------------ |
| `question`      | string | Yes      | The question asked by the user.                              |
| `selected_text` | string | No       | The block of text the user selected on the page, if any. The presence of this field triggers "Selected Text Mode". |

### Example

```json
{
  "question": "What is this component?",
  "selected_text": "A URDF (Unified Robot Description Format) file is an XML file used in ROS to describe all elements of a robot."
}
```

---

## 2. Agent Response

-   **Description**: The JSON object sent from the backend to the frontend in response to a query.

### Attributes

| Name      | Type   | Required | Description                                                  |
| --------- | ------ | -------- | ------------------------------------------------------------ |
| `answer`  | string | Yes      | The answer generated by the RAG agent.                       |
| `mode`    | string | Yes      | The execution mode used: `global_rag` or `selected_text`.    |
| `error`   | string | No       | An error message if the request failed.                      |

### Example (Success)

```json
{
  "answer": "Based on the text, a URDF is an XML file for describing a robot in ROS.",
  "mode": "selected_text"
}
```

### Example (Error)

```json
{
  "answer": null,
  "mode": "selected_text",
  "error": "The agent failed to generate a response."
}
```

---

## 3. Chat Message (Frontend)

-   **Description**: The data structure used by the frontend React component to manage and render the conversation history.
-   **Source**: [Feature Spec: Key Entities](spec.md#key-entities)

### Attributes

| Name        | Type   | Required | Description                                      |
| ----------- | ------ | -------- | ------------------------------------------------ |
| `id`        | string | Yes      | A unique identifier for the message (e.g., UUID). |
| `sender`    | string | Yes      | Who sent the message: `"user"` or `"agent"`.     |
| `content`   | string | Yes      | The text content of the message.                 |
| `timestamp` | string | Yes      | ISO 8601 timestamp of when the message was created. |

### Example

```json
{
  "id": "c1a2b3d4-e5f6-7890-1234-567890abcdef",
  "sender": "user",
  "content": "What is a URDF?",
  "timestamp": "2025-12-29T19:55:00Z"
}
```
